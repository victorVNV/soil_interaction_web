---
title: "Comunidad"
author: "VNV"
date: "2024-02-29"
output: html_document
editor_options: 
  markdown: 
    wrap: 90
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r lib, include=FALSE, warning=FALSE}
#Carga paquetes
{library("tidyverse");library("readxl");library("ade4") 
library("vegan");library("cluster");library("BiodiversityR") 
library("FactoMineR");library("factoextra")}
set.seed(167)

```

# Análisis de las comunidad

## Introducción

La Pampa argentina es una amplia llanura con una extensión de más de 120 millones de hectáreas, 
de las cuales se estima que la Pampa Ondulada ocupa 44 mil km^2^, esta ocupa la parte 
centro-oriental de la provincia de Córdoba, el norte de Buenos Aires y el suroeste de Santa Fé (.@.morello_etal_2000).

Fitogeográficamente, la Pampa Ondulada, se ubica en la Región Neotropical, dominio Chaqueño, distrito Oriental de la provincia Pampeana y en ella la vegetación dominante es la estepa o pseudoestepa de gramíneas (.@.Cabrera 1976, .@.Oyarzabal et al. 2018). El clima es templado con cuyo rango de precipitaciones varía entre los 850 a 1000 mm anuales y una temperatura media anual alrededor de los 17 ºC, la distribución de las lluvias es casi uniforme, interrumpida periódicamente por sequías derivadas de los fenómenos meteorogicos El Niño y La Niña. 

La Pampa Onduada es la zona más fértil y productiva de la región Pampeana, donde más del 80% de la tierra se dedica a la producción de cultivos agrícolas. Los suelos de la Pampa tienen relativamente pocas limitaciones para la producción de cultivos y son aptos para la ganadería. Son suelos profundos, bien drenados, no ofrecen limitaciones para el crecimiento de las raíces y tienen un buen contenido de materia orgánica (Cabrera y Willink 1973) la topografía es plana y extensa, además se encuentran en la región importante acuíferos cuya explotación se realiza para proporcionar riego a los cultivos, sumando a estas bondadosas características para la producción agrícola, el estrecho periodo de probabilidad de heladas y los inviernos sin nieve permiten el cultivo de especies invernales de manera que al año pueden realizarse hasta tres cosechas (.@.morello_etal_2000).

Urricariet y Lavado en 1999 ya mencionaban que la Pampa Ondulada estaba siendo 
sometida a la pérdida de fertilidad debidas a las prácticas intensivas de manejo. 
ellos basaban sus conjeturas en estudios regionales realizados en la Pampa Ondulada y
mencionan que la erosión de los suelos y los efectos de las prácticas agrícolas intensivas
sobre estos, alteran la fertilidad física y estructural del suelo, 
la fertilidad química principalmente por la disminución de 
nutrientes extraidos por los cultivos y la fertilidad biológica debida a las alteraciones 
sobre los procesos biológicos que tienen la perdida de la materia orgánica en los suelos. 
Podemos decir que las practicas agrícolas intensivas estaban motivadas por las grandes 
bondades productivas provistas por las características del ecosistema ante descrita.

Es importante conocer como es afectada la vida "bajo nuestros pies" 
(.@.fao_atlas_soil_biodiversity), es decir la vida del suelo, 
ya que la diversidad biológica puede ser afectada por diferentes factores relacionadas con las
diferentes prácticas de manejo, tales como, el establecimiento de diferentes estructuras vegetales, 
el fraccionamiento del hábitat, el cambio de uso del suelo, la compactación de los suelos, el
uso de insumos como fertilizantes y biocidas, y que alteran los fenómenos funcionales y
estructurales que conforman los procesos ecologicos de los ecosistemas terrestres (.@.citas; .@.Colombo_etal_2014; .@.bedano2006) 

La fauna edáfica refleja el efecto de las perturbaciones naturales y antrópicas mediante 
respuestas en su composición de especies o la abundancia de estos, ya que, las perturbaciones 
según su intensidad podrían llevar a la disminuciones de las abundancias y la desaparición 
de especies, lo que se traducirá en efectos sobre estabilidad y fertilidad de los suelos, dado
que, la fauna edáfica está íntimamente vinculada con la descomposición de la materia orgánica y la 
dinámica del ciclo de los nutrientes, además la diversidad trófica y la dinámica de los diferentes 
taxones se relacionan con el control de las poblaciones, la distribución y el transporte de esporas
y propágulos de la microflora del suelo, la deposición de sus extretas líquidas o sólidas que
contribuyen a la formación de microagregados y son almacen de carbono en el suelo y también sus
actividades de búsqueda de alimento o movimientos en búsqueda de mejores condiciones ambientales 
los tornan organismos que contribuyen, a diferentes escalas, a la formación del suelo.(.@.todas las 
citas). 

Por ello es que Socarras (2013) menciona que conocer el número de los diferentes taxones, 
su abundancia y el balance entre estos permite evaluar y predecir el impacto de los diferentes
métodos de producción ocurridos en sistemas con condiciones edáficas y climáticas particulares;
tambíen Cruz et al. (2009) mencionan en su síntesis sobre los indicadores que dan cuenta sobre la 
calidad del suelo, entendida como *"la utilidad del suelo para un propósito específico en una escala
amplia de tiempo"*, que los indicadores biológicos integran a la gran cantidad de factores que 
podrían estar afectando al suelo y su "calidad". Dado que el suelo es el hábitat de estos
organismos y la fauna edáfica es rectora sobre los procesos biológicos que afectan al 
funcionamiento del ecosistema edáfico, la diversidad biológica en los suelos se vincula 
estrechamente con el mantenimiento de la fertilidad, la estabilidad física y biológica y
con la productividad ecológica (productividad primaria) y económica (rendimiento de los cultivos
y producción de proteina animal) de los suelos.

El objetivo de esta sección es describir las comunidades.

## Materiales y métodos.
### Sitios de estudio

Las comunidades de la fauna del suelo trabajadas aquí ocurren en suelos Argiudoles típicos
de la Pampa Ondulada. Las comunidades se trabajan en dos conjuntos de datos, a saber,
fauna edáfica tomada en suelos del partido de Luján y fauna edáfica pertenecientes a 
suelos de los partidos de Chivilcoy y Navarro (Tabla 3.1[coordenadas]), estas distancias en la Pampa son prácticamente irrelevantes en términos de clima o elevación.

En ambos casos se tomaron muestras de suelos con diferentes formas de uso y se consideraron
estos como diferentes grados en la intensidad de perturbación sobre el suelo.

Los suelos de Luján fueron muestreados en una sola fecha en el
mes de Mayo del año 2022 y el trabajo de extracción, clasificación de los taxas y medición
de rasgos fué realizado por el autor y colaboradores.

Los suelos ubicados en los partidos de
Chivilcoy y Navarro fueron muestreados por Sandler (2019), en cada estación del año
durante dos años entre 2009 y 2010, dejando un conjunto de datos tanto con la
clasificación de los taxas de Arachnida: Acari, Hexapoda: Collembola y 
Oligochaetta: Crassiclitelata como con la caracterización de las variables físicas y
químicas. Además la organismos de la fauna mesofauna edáfica 
de estos lotes fueron preservados en el laboratorio de Ecología: programa de Ecología Terrestre
(INEDES-UNLu) lo que permitió al autor la medición de rasgos corporales.

** Tabla 3.1. Ubicación georreferenciada de los sitios de muestreo **
|Uso del suelo|Sitio de muestreo| Coordenadas |
|---|---|---|
| R |  L |S E   |
| PN|   C y N|S E   |
| P |   L|   |S E
| G |   C y N|S E   |
| A |   L |S E   |
| A |   C y N|S E   |

### Diseño de muestreo

Durante el mes de mayo del año 2022 se llevó adelante el muestreo de suelos Argiudoles
típicos ubicados el campo experimental de la Universidad Nacional de Luján (\@.sfeir_etal_1988_tesis_de_series\_) [imagen1_mapa].

El muestreo se llevó adelante con la intención de colectar la fauna edáfica que pasa todo
su ciclo de vida en el suelo (\@.momoyfalco_chap1; .@.walk_trabajo original), conocidos también como **geobiontes**.
Los geobiontes incluyen tres rangos de tamaño (\@.swift, agregar imagen tamaños y formas de vida):
la **microfauna** constituida por los nemátodos
(ancho corporal menor a 200 \$\mu m\$), la **mesofauna** en el que se incluyen los
microartrópodos y otros invertebrados cuyo diametro corporal es menor a 2 mm y la **macrofauna**.

De manera complementaria se estimaron, por un lado, la respiración heterotrófica, 
la biomasa de la microflora y la proporción de procariotas y eucariotas, 
y por el otro, las variables químicas y
físicas que caracterizan estos ambientes edáficos.

Se eligieron 3 sitios [Fig 3.1 Colocar imagendiseño muestreo] con diferentes usos del suelo 
y en cada sitio se ubicaron 3 réplicas
de un metro cuadrado de superficie separadas 50 metros entre sí y separadas 10 metros de
los bordes (\@.potapov_etal_2022; \@.moreira_etal_2012). 

Los sitios elegidos fueron: a) un lote agrícola (A) sobre el cuál se practica la
agricultura convencional con labranza para la producción forrajera de alfalfa 
*Medicago sativa* para pastoreo de bovinos en producción lechera; b) un área de 
pastizal natural (P) con dominancia de Sorgo de Alepo *Sorghum halepense* y 
Cardo mariano *Silybum marianum*,
áreas que reciben presión de pastoreo por los bovinos lecheros con descanso
entre pastoreos, y; c) un área clausurada por más de 30 años (R) considerada como reserva
cuya vegetación característica es de tipo arbórea dominada por Ligustro *Ligustrum lucidum* 
y Acacia *Acacia melanoxylon*.

### Métodos de extracción de la fauna edáfica. 

Para muestrear los nemátodos de vida libre del suelo para cada réplica muestral
se tomaron 4 submuestras, en puntos al azar dentro del área muestral de un metro cuadrado
previamente delimitada, con sacadocados de 5 cm diámetro y 10 cm de profundidad. 

Las submuestras fueron almacenadas evitando la compactación, la pérdida de humedad y el 
sobrecalentamiento para luego llevarlas al laboratorio donde se procedió a la
extracción de la microfauna. Las submuestras fueron mecladas, homogeneizadas y pesadas, luego cada 
muestra compuesta fué sometida al método de flotación y tamizado. (\@.mondino; \@.jekings; \@.moreira_etal_2012)

La muestra de suelo se desagrega suavemente con la mano y luego se incorpora agua en
relación 1:6 suelo:agua p/p se agita la solución enérgicamente durante 2 minutos
aproximadamente y luego se deja reposar unos minutos hasta que la fracción más pesada del
suelo decante, la solución se deja pasar a través de tamices con diferente diámetro de
apertura de malla y los nemátodos se colectan en las mallas con diámetro de apertura de
170 y 53 micrones; seguidamente se colecta los nemátodos atrapados por las mallas y se
conservan en formalina 4% (\@.moreira_etal_2012) o alcohol 96º (\@.potapov_etal_2022)
hasta su posterior conteo y extracción bajo lupa binocular, e identificación en grupos
tróficos según la morfología de su aparato bucal (\@.yeates; \@.mondino \@.momo-falco)
proceso que se realiza con montajes temporales y observación bajo microscopio óptico con aumentos de
hasta 400 veces.

Para extraer la macrofauna del suelo se trabajó en 2 etapas una a campo y otra en el
laboratorio, en ambos casos los animales se capturaban directamente utilizando pinzas y
pinceles y se los almacenaba directamente en alcohol de 96º (en inglés: *"Hand
shorting"*), hasta su posterior conteo e identificación (\@.potapov_etal_2022).

En el campo se delimitó dentro del área de muestreo de un metro cuadrado una sub-parcela,
ubicada al azar, de 25 x 25 cm y se excavó el suelo hasta los 20 cm de profundidad, esta
muestra se trabajó de manera estratificada separando en: hojarasca, suelo hasta los 10 cm y
suelo hasta los 20 cm de profundidad.

Para cada estrato las muestras de suelo fueron trasladadas al laboratorio, manteniendo el
suelo intacto y cuidando que no pierda la humedad natural para evitar la deshidratación de
la macrofauna hasta que el culmine el proceso de exploración y extracción de los animales,
proceso que llevo aproximadamente una semana (Fig 3.2).

[colocar mosaico de imágenes donde estamos suelo lupa y balanza]

Cada muestra de suelo fue desagregada minusiosamente, sobre fondo blanco, prestando
atención al movimiento de los animales de la macrofauna con la ayuda de lupa de mesa y luz
blanca, lo que permite capturar más animales que los que permite la exploración a campo
donde solo se factible observar aquellos animales ágiles o de gran tamaño, tales como,
lombrices de tierra, arañas lobo, bichos bolita, milpies, cienpies, entre otros.
(\@.potapov_etal_2022; \@.moreira_etal_2012)

Los animales capturados son almacenados en alcohol 96º hasta su identificación taxonómica.
Para la identificación se utilizaron claves taxonómicas que separan en grandes grupos
taxonómicos(.@.cita_libro_general_de_clasif). 
Las lombrices de tierra (Oligochaeta: Crassiclitellata) fueron identificadas
hasta especies (\@.Satchell_1983, \@.Reynolds_1996, \@.deMichisandMoreno_1999) y la
macrofauna restante fué separada en diferentes rangos taxonómicos desde órdenes hasta
familias (\@.Dindal 1990, \@.Klimaszewiski and Watt 1997, \@.Choate 1999, \@.Zhang 2011,
\@.Vargas et al. 2014, \@.Claps et al. 2020)

Para muestrear la comunidad de la mesofauna del suelo, se utilizaron los suelos
correspondientes a las muestras tomadas para capturar la macrofauna, de ellos se tomaron
la hojarasca y el suelo hasta la profundidad de 10 cm.

Se tomó toda la hojarasca que se encontraba sobre la superficie que cubría el monolito de
625 cm^2^, luego fue tamizada con malla de 2 mm separando así, de manera arbitraria, la
hojarasca "fresca" que es la que queda sobre el tamiz de 2mm de la hojarasca "fermentada"
y el suelo orgánico-mineral ("humus") que corresponden a la fracción que pasa el tamiz. 
La fracción que pasaba el tamiz fué considerado como hojarasca con un gran avance en
términos de descomposición (hojarasca fermentada según a bibliografía clásica (.@.citas), 
esta fracción luego fue separada por un tamiz de 500 $\mu m$ separando, también
de manera arbitraria, el "humus" que incluye el suelo orgánico mineral más porciones de
tejidos vegetal "amorfo" de la "hojarasca fragmentada" que es la que queda sobre el tamiz
de 500 $\mu m$.

El suelo del monolito de los primeros 10 centímetros de profundidad fue desagregado,
mezclado y homogeneizado para tomar tres submuestras de suelo con un volumen de 100 cm³,
previo a la toma de muestras el suelo fue disminuido en volumen mediante la técnica de
cuarteo, lo que asegura la representatividad de las fracciones submuestreadas.

Este procedimiento de estratificación se llevó adelante con la intención de conocer 
la diversidad de organismos de la mesofauna edáfica según el estrato de suelo 
considerando este procedimiento como proxi del hábitat más probable. 
Luego las submuestras fueron congeladas hasta el momento de la extracción de la mesofauna.

Las submuestras de la mesofauna edáfica fueron sometidas al método de flotación 
y tamizado (.@.palacios-vargas). Estas se desagregan en agua en relación 1:4 de suelo:agua, 
se agita enérgicamente durante 2 min, se deja reposar la solución durante unos minutos 
y luego se vuelca la solución a través del juego de tamices. 
El juego de tamices consistío en tamices apilados de 4 mm, 2mm, 1mm, 500 $\mu m$,
250 $\mu m$ y 170 $\mu m$; la mesofauna se colecta de lo que
queda atrapado en los tamices desde los 1000 $\mu m$ hasta las 170 $\mu m$.

Los animales colectados se almacenan en alcohol 96º, luego se procede al conteo e
identificación de los taxones en diferentes rangos taxonómicos hasta familias utilizando 
claves taxonómicas que pueden consultarse en: Burges and
Raw 1967, Balogh and Balogh 1972, Evans and Till 1979, Balogh and Balogh 1988, Dindal
1990, Krantz and Walter 2009, Momo and Falco 2009, Claps et al. 2020, Janssens 2023.

La metodología utilizada para extraer la fauna edáfica de 
los suelos de Chivilcoy y Navarro según describe Sandler (2019) implicó, 
el uso de la técnica de flotación y tamizado para extraer los ácaros y colémbolos
cuya identificación taxonómica se realizó con lupa binocular y microscopio óptico 
utilizando montaje temporal, y, el en el sitio y momento de muestreo de un marco 
de 625 cm^2^ hasta los 20 cm de profundidad el uso de la extracción manual de 
lombrices de tierra luego se realizó su posterior identificación
taxonómica bajo lupa binocular. 

Con el suelo de los primeros 10 cm de profundidad, porción en la cuál se desarrolla la 
mayor actividad de la microbiota (.@.librodesoilhealt), se llevó adelante la técnica de
respiración inducida por sustrato en conjunto con el uso de antibióticos tanto para
estimar la respiración heterotrófica del suelo y como para determinar la proporción de
procariotas y eucariotas halladas por gramo de suelo que resulta en la aproximación del
total de bacterias y hongos hallados en el suelo (\@.west1986; \@.zabala2010 paperRSI).

El procedimiento consiste en aplicar diferente soluciones, a razón 1:1 suelo:solución, con
antibióticos sobre cada gramo de suelo para estimular la respiración del grupo de interés,
el procedimiento se repite por cada muestra y réplica.

La solución con a) *solo* el sustrato no discrimina entre grupos contiene 150 mg glucosa /
mm solución y su valor estima la respiración heterotrófica total; la solución que b)
inhibe la respiración de procariotas y que por lo tanto mide la respiración de los
*eucariotas* contiene 11 mg cloranfenicol + 150 mg glucosa / mm sn.; c) la respiración de
*procariotas* se mide con la solución de 2,3 mg cicloheximia + 150 mg glucosa / mm y
finalmente la solución que contiene d) ambos antibióticos, en las mismas concentraciones,
estima la respiración *residual*, es decir, la respiración de aquellos organismos que
respiran a pesar de la presencia de los antibióticos en el medio líquido.

Se coloca un gramo de suelo / réplica / muestra en recipientes de 350 ml que se cierran
herméticamente y que funcionan como cámaras de incubación, luego el suelo es embebido con 
alguna de las soluciones descrita arriba y se coloca en el interior del recipiente la 
trampa de álcali, un frasco de menor volumen con 5 ml de solución de hidróxido de sodio 
NaOH O,1 M. Los recipientes se colocaron en estufa a 30ºC durante 48h para incubar el suelo
y estimular la actividad biológica. Como controles (blancos) de la reacción se utilizaron
frascos sin suelo con la trampa de álcali para medir el contenido de CO~2~ presente en la aire al momento del procedimiento. El CO~2~ liberado por la respiración biológica se recupera en la trampa
de NaOH y se determina por titulación con ácido clorhídrico HCl 0,1 M y fenolftaleína
como indicador (.@.coleman seccion de metodologias; .@.Frioni1986).

La biomasa microbiana se aproxima considerando que 1 ml HCl 0.1M, equivale a 2.2mg de
CO~2~ y que para un coeficiente de respiración igual a 1, se cumple que:

$$\frac{1\text{ mg CO}_2}{100\text{ g suelo}\times h}  = \frac{20.6\text{ mg C-biomasa}}{100\text{g suelo}}$$

Luego para la determinación de las proporciones de los grupos involucrados en la
respiración se consideran las diferencias observadas entre los grupos tratados con
antibioticos en relación con la respiración total (\@.zabala_2010).

```{=html}
<!--La respiración del suelo es un indicador de la actividad metabólica global del suelo
(Frioni, 1999). Mide la actividad microbiológica y de la microfauna del suelo. Es uno de
los parámetros más sensibles frente al impacto o disturbio del sistema. Para ello se
midió la respiración del suelo (expresada en μg de C-CO2 g -1 de suelo día -1) por
emisión y captación en solución de Na OH de CO2 de muestras de 20 g de suelo con
el contenido de humedad original. Se colocaron en recipientes de 350 ml, los cuales
contenían en su interior un recipiente menor en el centro del frasco con 20 ml de
NaOH 0,2 N. El sistema se cierra herméticamente y se incuba a 28 C durante 10 días.
El CO2 liberado por la respiración biológica se recupera en el recipiente con el Na OH.
Como controles de la reacción se utilizaron frascos sin suelo y con la trampa de álcali.
La producción de CO2 se determina por titulación con ácido HCl 0,2 N y fenolftaleína
como indicador (Frioni, 1999)-->
```

De manera complementaria se obtuvieron, a través del servicio del Laboratorio del Campo de 
la Universidad Nacional de Luján, los valores para el porcentaje de materia orgánica, 
el porcentaje de carbono, el carbono orgánico total, el porcentaje de nitrógeno, 
la cantidad de fósforo extratable en partes por millón, el valor del potencial de hidrogeniones 
en escala de pH y la conductividad eléctrica en milisiemens por centímetro.



### Análisis de datos

Para describir las variables físicas, químicas y biológicas medidas se realizó un análisis
descripivo de estas, para ello se calcularon las medidas de tendencia central y de disperción 
para cada sitio y estrato. Se compararon las posibles diferencias entre las medianas de estas variables utilizando el análisis de varianza no paramétrico de Kruskal-Wallis (.@.cita_libro_metodos_estadisticos). Luego se procede al análisis multivariado mediante el uso de componentes principales (PCA) para identificar las posibles relaciones entre las variables ambientales (.@.numerical_ecology).

Para describir la estructura de las comunidades edáficas se realizó el análisis de la 
diversidad alfa utilizando tanto el valor de la riqueza de unidades taxonómica como el índice de diversidad de Shanon-Wiener (**H'**). 
Además mediante análisis de similitudes multivariado (ANOSIM) se determinan las posibles diferencias
entre las comunidades, a la vez para conocer cuáles son las comunidades similares entre sí, se 
calculó el
dendograma basado en el agrupamiento jerárquico con el método de enlace promedio. En ambos análisis
se utilizó el coeficiente de distancia de Bray-Curtis (.@.Koleff et al 2003paper_Vegan; .@.numerical_ecology). 

Para describir las relación entre los taxones y los sitios de muestreo se realizó el
análisis de los componentes principales de las comunidades en modo R con los valores de
la abundancia de los taxones previamente transformados con $\log_b(x) + 1$ (\@.numerical_ecology)
de esta manera, podemos observar en el gráfico biplot a los sitios como 
vectores y a los taxones como puntos en el espacio euclidiano de las coordenadas 
principales.

<!-- indice de Wilson y Schmida 1984 en Measuring beta diversity for presence–absence data Koleff et al 2003  y numerical ecology con R libro-->

<!--La prueba de los rangos con signo de Wilcoxon es una prueba no paramétrica para comparar el rango medio de dos muestras relacionadas y determinar si existen diferencias entre ellas. Se utiliza como alternativa a la prueba t de Student cuando no se puede suponer la normalidad de dichas muestras. Esta prueba es útil para comparar dos mediciones relacionadas y determinar si la diferencia entre ellas se debe al azar o no.-->

```{=html}
<!--La identificación taxonómica se realizó al máximo nivel de resolución posible mediante
el uso de claves. Los grupos analizados fueron: Macrofauna: Lumbricina, Formicidae,
Isoptera, Isopoda, Coleoptera (total y por familias), Araneae, Diplopoda, Chilopoda,
Enchytraidae, Hymenoptera, Gastropoda, Symphyla, Nematomorpha, Gryllidae,
Blattide, Gryllotalpidae, Homoptera, Hemiptera y Thysanuridae. Mesofauna: Acari
(Oribatida, Mesostigmata, Prostigmata y Astigmata) y Collembola.
Se determinó el aporte porcentual de cada uno de los taxones a la fauna total
recolectada en los años de estudio, discriminando de acuerdo a la época de muestreo
y al tratamiento.
-->

<!--Imágenes ![texto_alternativo](ubicacion_de_la_imagen){width=width height=height}-->
```
## Resultados

```{r carga_variablesFQB, include=FALSE}

library("tidyverse")
fyq_unlu <- read.delim("~/Documentos/Redes/soil_interaction_web/database/fyq_unlu.txt")


####
# Respiración heterotrófica
# Valores expresados en miligramos de CO2/h/100g suelo

resp.b<-c( 0.131588785046729,0.14803738317757,0.14803738317757, #Pastizal
           0.188187372708758,0.15234215885947,0.170264765784114, #Reserva
           0.066236559139785,0.0851612903225806,0.0946236559139785) #Agrícola



# Relación de hongos : bacterias

#pasar las relaciones decimales a fracción
ratio.hb<-c( 11/8, 11/6, 7/6, #Pastizal
            2.42857142857143, 11/6, 3.5, #Reserva
                       3.25, 14/3, 5/6) #Agrícola

#Agrícola, corrección de 14 por 4.66 (como? usando la biomasa residual)
# en agrícola existe un valor atípico de 14 y lo corregi a 1.4


#hojarasca g/m2
h<-c(
  70.85*16, #P
44.15*16,
60.9*16,
48.81*16, #R
64.319*16,
54.13*16,

80.6664*16, #A
46.009*16,
104.421*16)



```



#### Descriptivas

```{r matrices_FQB, echo=FALSE}

fyq.box<-fyq_unlu%>%mutate(
  sistema=substr(Sitio, 3, 3),
                       estrato=substr(Sitio, 1, 2),
                       replica=substr(Sitio, 4, 4),
 )
names(fyq.box)<-c("nombre","muestra","CE","pH","MO","C","P","N","TOC","D_TOC_C","C_TOC","sitio","estrato","replica")
#se eligen las variables de interés

fyq.box<-fyq.box[,c(1,12,14,13,3,4,5,8,7)]

resp.b<-c(0.131588785046729,0.14803738317757,0.14803738317757, #Pastizal
          0.188187372708758,0.15234215885947,0.170264765784114, #Reserva
          0.066236559139785,0.0851612903225806,0.0946236559139785) #Agrícola

#agrego relación Hongo-Bacterias
ratio.hb<-c( 1.375, 1.83333333333333, 1.16666666666667, #Pastizal
             2.42857142857143, 1.83333333333333, 3.5, #Reserva
             3.25, 1.4, 0.833333333333333) #Agrícola


fqb.box<-data.frame(resp.b,ratio.hb,h,sitio=c(rep("P",3),rep("R",3),rep("A",3)),estrato=rep(10,9))

```

La conductividad eléctrica medida en milisiemens por centímetro (ms/cm) fue determinada
para el estrato de 10 a 20 cm. En cada sitio se observa claras diferencias y esto se
convalida con el test de K-W p:H\<0.01, en el gráfico de cajas y bigotes se observa el
mayor valor de CE se da en el pastizal natural, seguido del lote agrícola

```{r CE_unlu,echo=FALSE}
CE.sum<-data.frame(Sitio=c("A 20", "P 20", "R 20"),
                   Promedio=c(
                     mean(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"CE"]),
                     mean(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"CE"]),
                     mean(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"CE"])
                     ),
                   'Desvío estándar'=c(
                     sd(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"CE"]),
                     sd(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"CE"]),
                     sd(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"CE"])
                     ),
                    Mediana=c(
                     median(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"CE"]),
                     median(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"CE"]),
                     median(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"CE"])
                     ),
                   '1er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"CE"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"CE"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"CE"],
                              probs=0.25)
                     ),
                   '3er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"CE"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"CE"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"CE"],
                              probs=0.75)
                     ),
                   row.names = NULL)

print(CE.sum)

# Crear los boxplots para cada variable
kruskal.test(CE ~ sitio, data = fyq.box, subset=fyq.box$estrato==20)
pairwise.wilcox.test(fyq.box$CE, fyq.box$sitio,data=fyq.box,
                     subset=fyq.box$estrato==20,
                     p.adjust.method = "BH")
{boxplot(CE ~ sitio+estrato, data = fyq.box, main = "Conductividad Eléctrica ms/cm")
# Calcular las coordenadas para colocar las letras
# Puedes ajustar estas coordenadas según la posición deseada
x_coords <- c(1.3, 2.3, 3.3)  # Coordenadas x para las letras
y_coords <- rep(55, 3)  # Coordenadas y para las letras

# Letras a colocar
letras <- c("b", "a", "c")

# Agregar las letras al gráfico
text(x = x_coords, y = y_coords, labels = letras, col = "black", cex = 0.9)}


```




Los valores de pH fueron similares entre sitios considerando el suelo mineral que se halla
entre los 10 - 20 cm.

```{r pH_unlu,echo=FALSE}


pH.sum<-data.frame(Sitio=c("A 20", "P 20", "R 20"),
                   Promedio=c(
                     mean(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"pH"]),
                     mean(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"pH"]),
                     mean(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"pH"])
                     ),
                   'Desvío estándar'=c(
                     sd(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"pH"]),
                     sd(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"pH"]),
                     sd(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"pH"])
                     ),
                    Mediana=c(
                     median(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"pH"]),
                     median(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"pH"]),
                     median(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"pH"])
                     ),
                   '1er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"pH"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"pH"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"pH"],
                              probs=0.25)
                     ),
                   '3er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"pH"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"pH"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"pH"],
                              probs=0.75)
                     ),
                   row.names = NULL)
print(pH.sum)


# Crear los boxplots para cada variable
kruskal.test(pH ~ sitio, data = fyq.box, subset=fyq.box$estrato==20)
pairwise.wilcox.test(fyq.box$pH, fyq.box$sitio,data=fyq.box,
                     subset=fyq.box$estrato==20,
                     p.adjust.method = "BH",exact=FALSE)

boxplot(pH ~ sitio+estrato, data = fyq.box, main = "potencial Hidrógeno")

#no hay diferencias, la prueba areada dice R ab ;P b ;L bc
# Calcular las coordenadas para colocar las letras
# Puedes ajustar estas coordenadas según la posición deseada
#x_coords <- c(1.3, 2.3, 3.3)  # Coordenadas x para las letras
#y_coords <- rep(9, 3)  # Coordenadas y para las letras

# Letras a colocar
#letras <- c("b", "a", "c")

# Agregar las letras al gráfico
#text(x = x_coords, y = y_coords, labels = letras, col = "black", cex = 0.9)}


```

El porcentaje de materia orgánica del suelo no resulto diferente al valor H:p\<0.05, pero
se observan diferencias en los diferentes estratos. En el estrato superficial (0 a 10cm)
el %MO fue mayor en la reserva seguido por el pastizal natural, esto se relaciona con la
vegetación que se mantine sobre el suelo, en cambio en el lote el % de MO es menor en el
primer estrato. Con respecto al estato más profundo (10 a 20 cm) la tendencia se invierte,
el Lote agrícola y el pastizal muestran valores similares y mayores que el de la reserva,
esto puede ser explicado en el fenómeno de la lixiviación que arrastra componentes del
estrato superior del suelo y se acumula en el estrato inmediatamente inferior, en cambio
en vegetación tipo boscosa como lo es la reserva la mayor proporción de materia orgánica
se encontraría en pie y a la vez lo lixiviado seria utilizado por la vegetación viva por
parte de las raices que exploran el suelo más allá de la capa superficial del suelo.

```{r MO_unlu,echo=FALSE}

MO.sum<-data.frame(Sitio=c("A 10", "P 10", "R 10","A 20", "P 20", "R 20"),
                   Promedio=c(mean(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"MO"]),
                     mean(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"MO"]),
                     mean(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"MO"]),
                     mean(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"MO"]),
                     mean(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"MO"]),
                     mean(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"MO"])
                     ),
                   'Desvío estándar'=c(
                     sd(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"MO"]),
                     sd(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"MO"]),
                     sd(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"MO"]),
                     sd(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"MO"]),
                     sd(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"MO"]),
                     sd(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"MO"])
                     ),
                    Mediana=c(
                      median(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"MO"]),
                     median(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"MO"]),
                     median(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"MO"]),
                     median(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"MO"]),
                     median(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"MO"]),
                     median(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"MO"])
                     ),
                   '1er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"MO"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"MO"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"MO"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"MO"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"MO"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"MO"],
                              probs=0.25)
                     ),
                   '3er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"MO"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"MO"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"MO"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"MO"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"MO"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"MO"],
                              probs=0.75)
                     ),
                   row.names = NULL)

print(MO.sum)


# Crear los boxplots para cada variable
kruskal.test(MO ~ sitio, data = fyq.box, subset=fyq.box$estrato==10)
kruskal.test(MO ~ sitio, data = fyq.box, subset=fyq.box$estrato==20)
pairwise.wilcox.test(fyq.box$MO, fyq.box$sitio,data=fyq.box,
                     subset=fyq.box$estrato==10,
                     p.adjust.method = "BH")
pairwise.wilcox.test(fyq.box$MO, fyq.box$sitio,data=fyq.box,
                     subset=fyq.box$estrato==20,
                     p.adjust.method = "BH")
#no significativo al p=0.05
boxplot(MO ~ sitio+estrato, data = fyq.box, main = "% Materia Orgánica")

```

Con relación al porcentaje de Nitrógeno en el suelo la prueba de diferencia de las
medianas K-W no indica diferencias al p\<0.05 en a capa superficial del suelo, pero si
indica diferencias significactivas en la capa subsuperficial.

El % de Nitrógeno en el suelo en ambos estratos fué mayor en el lote agrícola y esto puede
estar reflejando las fertilizaciones que recibe este suelo para llevar adelante la
producción de forraje, ya sea debido a la fijación biológica por parte de los rizobios
mutualistas con la alfalfa o fertilización mineral. En la capa superficial, el menor valor
se observa en el pastizal natural lo que se relaciona con la demanda de nitrógeno para el
desarrollo de los pastizales, la reserva se posiciona en un lugar intermedio y su
contenido puede relacionarse con la mineraliación del nutriente debido al proceso de
descomposición y humificación de la hojarasca que se deposita sobre la superficie del
suelo.

En el estrato subsuperficial la relación entre las medianas es de mayor a menor lote
agrícola, pastizal y reserva. Con respecto al pastizal podemos relacionar esto con el
lixiviado del nitrógeno y la poca exploración de las raices en estas profundidades lo que
se observa en los valores atípicos, en sentido contrario la demanda de nitrógeno por las
raices de la vegetación arbórea podría estar relacionada con la menor concentracion de N
en el estrato inferior.

```{r N_unlu,echo=FALSE}

N.sum<-data.frame(Sitio=c("A 10", "P 10", "R 10","A 20", "P 20", "R 20"),
                   Promedio=c(mean(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"N"]),
                     mean(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"N"]),
                     mean(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"N"]),
                     mean(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"N"]),
                     mean(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"N"]),
                     mean(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"N"])
                     ),
                   'Desvío estándar'=c(
                     sd(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"N"]),
                     sd(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"N"]),
                     sd(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"N"]),
                     sd(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"N"]),
                     sd(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"N"]),
                     sd(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"N"])
                     ),
                    Mediana=c(
                      median(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"N"]),
                     median(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"N"]),
                     median(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"N"]),
                     median(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"N"]),
                     median(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"N"]),
                     median(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"N"])
                     ),
                   '1er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"N"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"N"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"N"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"N"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"N"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"N"],
                              probs=0.25)
                     ),
                   '3er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"N"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"N"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"N"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"N"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"N"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"N"],
                              probs=0.75)
                     ),
                   row.names = NULL)
print(N.sum)

# Crear los boxplots para cada variable
kruskal.test(N ~ sitio, data = fyq.box, subset=fyq.box$estrato=="10")
kruskal.test(N ~ sitio, data = fyq.box, subset=fyq.box$estrato=="20")
pairwise.wilcox.test(fyq.box$N, fyq.box$sitio,data=fyq.box,
                     subset=fyq.box$estrato==10,
                     p.adjust.method = "BH",exact=FALSE)
pairwise.wilcox.test(fyq.box$N, fyq.box$sitio,data=fyq.box,
                     subset=fyq.box$estrato==20,
                     p.adjust.method = "BH",exact=FALSE)
boxplot(N ~ sitio+estrato, data = fyq.box, main = "% Nitrógeno")

```

Con respecto al fósforo claramente al ser un nutriente poco movil y disponible, la
amplitud de los valores para el lote agrícola en ambos estratos refleja la fertilización
de este nutriente sobre el suelo. En los demás sitios los valores de la concentración de
fósforo fueron similares en ambos estratos tanto para la reserva como para el pastizal
natural.

```{r P_unlu, echo=FALSE}

P.sum<-data.frame(Sitio=c("A 10", "P 10", "R 10","A 20", "P 20", "R 20"),
                   Promedio=c(mean(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"P"]),
                     mean(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"P"]),
                     mean(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"P"]),
                     mean(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"P"]),
                     mean(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"P"]),
                     mean(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"P"])
                     ),
                   'Desvío estándar'=c(
                     sd(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"P"]),
                     sd(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"P"]),
                     sd(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"P"]),
                     sd(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"P"]),
                     sd(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"P"]),
                     sd(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"P"])
                     ),
                    Mediana=c(
                      median(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"P"]),
                     median(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"P"]),
                     median(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"P"]),
                     median(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"P"]),
                     median(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"P"]),
                     median(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"P"])
                     ),
                   '1er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"P"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"P"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"P"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"P"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"P"],
                              probs=0.25),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"P"],
                              probs=0.25)
                     ),
                   '3er. Cuartil'=c(
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==10,"P"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==10,"P"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==10,"P"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="A"&fyq.box$estrato==20,"P"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="P"&fyq.box$estrato==20,"P"],
                              probs=0.75),
                     quantile(fyq.box[fyq.box$sitio=="R"&fyq.box$estrato==20,"P"],
                              probs=0.75)
                     ),
                   row.names = NULL)

print(P.sum)
# Crear los boxplots para cada variable
kruskal.test(P ~ sitio, data = fyq.box, subset=fyq.box$estrato==10)
kruskal.test(P ~ sitio, data = fyq.box, subset=fyq.box$estrato==20)
pairwise.wilcox.test(fyq.box$P, fyq.box$sitio,data=fyq.box,
                     subset=fyq.box$estrato==10,
                     p.adjust.method = "BH",exact=FALSE)
pairwise.wilcox.test(fyq.box$P, fyq.box$sitio,data=fyq.box,
                     subset=fyq.box$estrato==20,
                     p.adjust.method = "BH",exact=FALSE)
{boxplot(P ~ sitio+estrato, data = fyq.box, main = "Fósforo intercambiable p.p.m.")
x_coords <- c(1.3, 2.3, 3.3,4.3, 5.3, 6.3)  # Coordenadas x para las letras
y_coords <- rep(30, 3)  # Coordenadas y para las letras

# Letras a colocar
letras <- c("a", "b", "b","c", "d", "d")

# Agregar las letras al gráfico
text(x = x_coords, y = y_coords, labels = letras, col = "black", cex = 0.9)}


```

La respiración heterotrófica se midió para el estrato que corresponde hasta los 10 cm de
profundidad dado que allí se da la mayor actividad de los microorganismos involucrados en
el metabolismo del suelo (\@.aca colocar la cita del libro verde). Se observan diferencias
significaivas en las medianas entre los sitios, la reserva muestra el mayor valor de
resiracion seguido de cerca por el pastizal y con el cual no muestra diferencias
significativas y el valor mas bajo se da en el agrícola el cual si difiere de ambos
grupos. Basicamente en los suelos permanentemente cubiertos la actividad biológica de la
microbiota/microflora es mayor.

```{r resp_het,echo=FALSE}

rH.sum<-data.frame(Sitio=c("A 10", "P 10", "R 10"),
                   Promedio=c(
                     mean(fqb.box[fqb.box$sitio=="A","resp.b"]),
                     mean(fqb.box[fqb.box$sitio=="P","resp.b"]),
                     mean(fqb.box[fqb.box$sitio=="R","resp.b"])
                     ),
                   'Desvío estándar'=c(
                     sd(fqb.box[fqb.box$sitio=="A","resp.b"]),
                     sd(fqb.box[fqb.box$sitio=="P","resp.b"]),
                     sd(fqb.box[fqb.box$sitio=="R","resp.b"])
                     ),
                    Mediana=c(
                     median(fqb.box[fqb.box$sitio=="A","resp.b"]),
                     median(fqb.box[fqb.box$sitio=="P","resp.b"]),
                     median(fqb.box[fqb.box$sitio=="R","resp.b"])
                     ),
                   '1er. Cuartil'=c(
                     quantile(fqb.box[fqb.box$sitio=="A","resp.b"],
                              probs=0.25),
                     quantile(fqb.box[fqb.box$sitio=="P","resp.b"],
                              probs=0.25),
                     quantile(fqb.box[fqb.box$sitio=="R","resp.b"],
                              probs=0.25)
                     ),
                   '3er. Cuartil'=c(
                     quantile(fqb.box[fqb.box$sitio=="A","resp.b"],
                              probs=0.75),
                     quantile(fqb.box[fqb.box$sitio=="P","resp.b"],
                              probs=0.75),
                     quantile(fqb.box[fqb.box$sitio=="R","resp.b"],
                              probs=0.75)
                     ),
                   row.names = NULL)
print(rH.sum)
# Crear los boxplots para cada variable
kruskal.test(resp.b ~ sitio, data = fqb.box)

pairwise.wilcox.test(fqb.box$resp.b, fqb.box$sitio,data=fqb.box,
                     p.adjust.method = "BH",exact=FALSE)

{boxplot(resp.b ~ sitio+estrato, data = fqb.box, main = "Respiración Heterotrófica")
x_coords <- c(1.3, 2.3, 3.3)  # Coordenadas x para las letras
y_coords <- rep(0.1, 3)  # Coordenadas y para las letras

# Letras a colocar
letras <- c("b", "a", "a")

# Agregar las letras al gráfico
text(x = x_coords, y = y_coords, labels = letras, col = "black", cex = 0.9)}



```

```{r ratioHB,echo=FALSE}

ratHB.sum<-data.frame(Sitio=c("A 10", "P 10", "R 10"),
                   Promedio=c(
                     mean(fqb.box[fqb.box$sitio=="A","ratio.hb"]),
                     mean(fqb.box[fqb.box$sitio=="P","ratio.hb"]),
                     mean(fqb.box[fqb.box$sitio=="R","ratio.hb"])
                     ),
                   "Desvío estándar"=c(
                     sd(fqb.box[fqb.box$sitio=="A","ratio.hb"]),
                     sd(fqb.box[fqb.box$sitio=="P","ratio.hb"]),
                     sd(fqb.box[fqb.box$sitio=="R","ratio.hb"])
                     ),
                    Mediana=c(
                     median(fqb.box[fqb.box$sitio=="A","ratio.hb"]),
                     median(fqb.box[fqb.box$sitio=="P","ratio.hb"]),
                     median(fqb.box[fqb.box$sitio=="R","ratio.hb"])
                     ),
                   "1er. Cuartil"=c(
                     quantile(fqb.box[fqb.box$sitio=="A","ratio.hb"],
                              probs=0.25),
                     quantile(fqb.box[fqb.box$sitio=="P","ratio.hb"],
                              probs=0.25),
                     quantile(fqb.box[fqb.box$sitio=="R","ratio.hb"],
                              probs=0.25)
                     ),
                   "3er. Cuartil"=c(
                     quantile(fqb.box[fqb.box$sitio=="A","ratio.hb"],
                              probs=0.75),
                     quantile(fqb.box[fqb.box$sitio=="P","ratio.hb"],
                              probs=0.75),
                     quantile(fqb.box[fqb.box$sitio=="R","ratio.hb"],
                              probs=0.75)
                     ),
                   row.names = NULL)

print(ratHB.sum)

# Crear los boxplots para cada variable
kruskal.test(ratio.hb ~ sitio, data = fqb.box)

pairwise.wilcox.test(fqb.box$ratio.hb, fqb.box$sitio,data=fqb.box,
                     p.adjust.method = "BH",exact=FALSE)

boxplot(ratio.hb ~ sitio+estrato, data = fqb.box, main = "Relación Eucariotas:Procariotas")

```

Con respecto a la relación entre eucariotas:procariotas que indica la proporcion de hongos
y bacteria que forman parte de la actividd de la respiración heterotrófica, no se
observaron diferencias significativas. Pero observando las medianas en la reserva la
relación de eucariotas:procariotas es mayor, lo que indica una mayor proporcion de la
actividad de hongos en este sitio y ello está ligado a un sistema más maduro o a la
actividad de descomposición de la hojarasca por parte de hongos y micorrizas. En el caso
del lote agrícola el valor de su mediana es similar al del pastizal pero el rango
intercuartílico es más amplio lo que muestra que la proporción de hongos que intervienen
en el metabolismo del suelo es heterogéneo y dependerá del punto de muestreo, en cambio el
valor del pastizal refleja una mayor estabilidad del microbioma en el lote.

```{r hojarasca, echo=FALSE}

h.sum<-data.frame(Sitio=c("A 10", "P 10", "R 10"),
                   Promedio=c(
                     mean(fqb.box[fqb.box$sitio=="A","h"]),
                     mean(fqb.box[fqb.box$sitio=="P","h"]),
                     mean(fqb.box[fqb.box$sitio=="R","h"])
                     ),
                   "Desvío estándar"=c(
                     sd(fqb.box[fqb.box$sitio=="A","h"]),
                     sd(fqb.box[fqb.box$sitio=="P","h"]),
                     sd(fqb.box[fqb.box$sitio=="R","h"])
                     ),
                    Mediana=c(
                     median(fqb.box[fqb.box$sitio=="A","h"]),
                     median(fqb.box[fqb.box$sitio=="P","h"]),
                     median(fqb.box[fqb.box$sitio=="R","h"])
                     ),
                   "1er. Cuartil"=c(
                     quantile(fqb.box[fqb.box$sitio=="A","h"],
                              probs=0.25),
                     quantile(fqb.box[fqb.box$sitio=="P","h"],
                              probs=0.25),
                     quantile(fqb.box[fqb.box$sitio=="R","h"],
                              probs=0.25)
                     ),
                   "3er. Cuartil"=c(
                     quantile(fqb.box[fqb.box$sitio=="A","h"],
                              probs=0.75),
                     quantile(fqb.box[fqb.box$sitio=="P","h"],
                              probs=0.75),
                     quantile(fqb.box[fqb.box$sitio=="R","h"],
                              probs=0.75)
                     ),
                   row.names = NULL)

print(h.sum)


# Crear los boxplots para cada variable
kruskal.test(h ~ sitio, data = fqb.box)

pairwise.wilcox.test(fqb.box$h, fqb.box$sitio,data=fqb.box,
                     p.adjust.method = "BH",exact=FALSE)

boxplot(h ~ sitio+estrato, data = fqb.box, main = "Biomasa de la hojarasca")


```


Para los valores de hojarasca en metros cuadrados mediante la prueba estadística de K-W no se observan valores de diferencias entre los sitios, sin embargo los gráficos de cajas y bigotes nos muestran que la cantidad de hojarasca en el suelo agrícola tiene un mayor biomasa que een los demás sistemas, además se observa el valor más bajo de la mediana y con una dispersión más estrecha en el sistema de la Reserva.

```{r matriz_pca, include=FALSE}

fyq_unlu <- read.delim("~/Documentos/Redes/soil_interaction_web/database/fyq_unlu.txt")
fyq.pca<-fyq_unlu%>%mutate(sitio=substr(Sitio, 3, 3),
                       estrato=substr(Sitio, 1, 2),
                       replica=substr(Sitio, 4, 4),
                       nombre=paste(sitio,replica))%>%
  group_by(sitio,replica,nombre)%>%
  summarise(CE=mean(CE..Ms.,na.rm=TRUE),CE.sd=sd(CE..Ms.,na.rm=TRUE),
            pH=mean(PH,na.rm=TRUE),pH.sd=sd(PH,na.rm=TRUE),
            MO=mean(MATERIA.ORGÁNICA,na.rm=TRUE),MO.sd=sd(MATERIA.ORGÁNICA,na.rm=TRUE),
            C=mean(CARBONO,na.rm=TRUE),C.sd=sd(CARBONO,na.rm=TRUE),
            TOC=mean(TOC,na.rm=TRUE),TOC.sd=sd(TOC,na.rm=TRUE),
            N=mean(NITRÓGENO,na.rm=TRUE),N.sd=sd(NITRÓGENO,na.rm=TRUE),
            P=mean(FÓSFORO,na.rm=TRUE),P.sd=sd(FÓSFORO,na.rm=TRUE))%>%
  distinct(nombre,.keep_all=TRUE)

#agrego respiración en CO2/h/g
fyq.pca$resp.b<-c(0.066236559139785,0.0851612903225806,0.0946236559139785,
                    0.131588785046729,0.14803738317757,0.14803738317757,
                    0.188187372708758,0.15234215885947,0.170264765784114)
#agrego relación Hongo-Bacterias
fyq.pca$ratio.hb<-c(3.25, 1.400000000001, 0.833333333333333,
                       1.375, 1.83333333333333, 1.16666666666667,
                       2.42857142857143, 1.83333333333333, 3.5)
#Valores expresados en microgramos de C-biomasa/g suelo
fyq.pca$ug_biom_x_g<-c(1.80305376344086, 2.14417204301075, 1.70559139784947,
3.78435845213849, 3.50745417515275, 3.87665987780041, 2.62601869158878,
3.4731214953271, 2.37188785046729)*1000


# con la idea de tener la cantidad de hongos y bacterias
# densidad aparente 1,47 g/cm3 (sacado del promedio pastura, agricola, reserva, tesina
#Veronica)
# suelo a 5 cm en un m2 son 50k cm3 aprox 0.5m3, esto es, 73500 g en 0.5m3 suelo 
# más factor 1e6 para microgramos


fyq.pca$bio.micro<-fyq.pca$ug_biom_x_g*73500


fyq.pca$fungi<-round(fyq.pca$bio.micro*(fyq.pca$ratio.hb/(fyq.pca$ratio.hb+1)),4)
fyq.pca$bacteria<-round((fyq.pca$bio.micro-fyq.pca$fungi),4)
hj<-c(80.6664*16, 46.009*16, 104.421*16,#A
  70.85*16,44.15*16,60.9*16,#P
48.81*16,64.319*16,54.13*16 #R
) 
fyq.pca$hojarasca<-hj

#write.table(unlu_merg[,c(1,2,3,4,6,8,10,12,14,16,258:263,20:138)],"matrizunlu.txt")

```

```{r corFQB_unlu, echo=FALSE}
fq1<-fyq.pca[,c(4,6,8,14,16,18,19,24)]
fq1<-as.data.frame(fq1)
row.names(fq1)<-fyq.pca$nombre

corr_fqb_unlu<-Hmisc::rcorr(as.matrix(fq1),type = "pearson");
print(corr_fqb_unlu[3])
print(corr_fqb_unlu[1])

#corrplot::corrplot(cor(fq1),tl.pos="t",type = "upper",tl.col = "black",tl.cex = .8,bg="brown4",diag=FALSE)
#col=col3(100),
```

La matriz de correlaciones de a pares nos muestran que las variables no están
correlacionadas entre si con excepción de fósforo y el nitrógeno que se correlacionan con
la respiración heterotrófica, esto se observa mediante el valor de significacia de menor
al p\<0.05, se observa tambien una significacancia marginal con valor p\<0.1 entre el P y
N lo que puede estar reflejando el efecto conjunto de la respiración heterotrófica.

Considerando que los organismos requieren de nutrientes y que justamente el P y N forman
parte de los macronutrientes, puede ligarse la concentracion de estos con la respiración
heterotrofica, aunque en este caso nos muestran correlaciones negativas, es decir, mayores
concentraciones de estos nutrientes menor es la actividad respiratoria por parte de los
heterótrofos, lo que podría reflejar un mecanismo de retroalimentacion negativa si
consideramos que el papeel de la microbiota esta ligada a la descomposición y
mineraliación de los nutrientes

La relacion entre el nitrógeno y el fósforo es positiva, lo que puede ser debido al efecto
de la fertilización con compuestos que poseen ambos componentes.

#### Análisis multivariado

```{r PCA, echo=FALSE, warning=FALSE}
library("FactoMineR");library("factoextra")
#tb_fq<-decostand(fq1,"log")

#f_pca<-PCA(tb_fq, scale.unit = TRUE, graph = FALSE)
#No se transformará solo dejar para las comunidades
unlu_pcaFQB<-PCA(fq1, scale.unit = TRUE, graph = FALSE)

#Biplot
sit<-sit<-c(rep("L", 3), rep("P", 3), rep("R", 3))
fviz_pca_biplot(unlu_pcaFQB, axes = c(1,2),  col.ind=sit, label = "var")

print(unlu_pcaFQB$eig)
#summary(f_pca)
##corelaciones
f_pca_cor<-round(unlu_pcaFQB$var$cor[,1:3],3);
print("-----------------------------");
#print(f_pca_cor)


```

Los primeros 2 ejes explican el 60 % de la variabilidad Acorde a las variables Fy Q se
separan los tres sistemas de uso. El pH y la MO se encuentrn estrechamente relacionadas y
se relacionan con la R reserva

el P y N se relacionan con los sitios de uso Agrícola, el lote de Alfalfa Lo que tiene
sentido si asumimos el uso de fertilizantes, además al momento de muestreo la alfalfa se
encontraba sin follaje.

La CE se relaciona con el pastizal.

### Diversidad de las comunidades edáficas que habitan los suelos de la UNLu

```{r mat_D,include=FALSE}
ab_bulk <- read.csv("database/ab_bulk.txt", sep="")
ab_bulk[ab_bulk$sitio == "L", "sitio"] <- "A"
###########
#Llevando abundancias a densidad

#microfauna (se contaron los nemátodos de 4 sacabocados)
sup.bocado.micro <- (1/(pi*2.5^2/10000))*4
#mesofauna (se contaron y extrajeron de 3 frasquitos homojeneizados del monolito)
sup.bocado.meso <- (1/(pi*2.5^2/10000))*3
#macrofauna (superficie estandar 25 x 25)
sup.monolito <- 1/(0.25*0.25)

unlu_full<-ab_bulk%>%
  mutate(nombre=paste(sitio,replica))%>%
           mutate(
             D=floor(case_when(
  class=="macrofauna"~sup.monolito*abundance,
  class=="mesofauna"~sup.bocado.meso*abundance,
  class=="microfauna"~sup.bocado.micro*abundance)
  )
  )

####################
#Matriz comunidad

unlu_ab<-unlu_full[,c("nombre","sitio","replica","taxon","D","abundance")] %>% 
  pivot_wider(names_from = taxon,
              values_from = c(D,abundance),
              values_fill = 0,
              values_fn = sum)%>%
  distinct(nombre,.keep_all=TRUE)

#Renombrar Lote L, por A de agrícola

#unlu_ab[unlu_ab$sitio == "L", "sitio"] <- "A"

##############
# variables microbiológicas adjuntas a la matriz de datos
unlu_merg<-unlu_ab
#agrego respiración en CO2/h/g
unlu_merg$resp.b<-c(0.066236559139785,0.0851612903225806,0.0946236559139785,
                    0.131588785046729,0.14803738317757,0.14803738317757,
                    0.188187372708758,0.15234215885947,0.170264765784114)
#agrego relación Hongo-Bacterias
unlu_merg$ratio.hb<-c(3.25, 1.400000000001, 0.833333333333333,
                       1.375, 1.83333333333333, 1.16666666666667,
                       2.42857142857143, 1.83333333333333, 3.5)
#Valores expresados en microgramos de C-biomasa/g suelo
unlu_merg$ug_biom_x_g<-c(1.80305376344086, 2.14417204301075, 1.70559139784947,
3.78435845213849, 3.50745417515275, 3.87665987780041, 2.62601869158878,
3.4731214953271, 2.37188785046729)*1000

# con la idea de tener la cantidad de hongos y bacterias
# densidad aparente 1,47 g/cm3 (sacado del promedio pastura, agricola, reserva, tesina
#Veronica)
# suelo a 5 cm en un m2 son 50k cm3 aprox 0.5m3, esto es, 73500 g en 0.5m3 suelo 
# más factor 1e6 para microgramos


unlu_merg$bio.micro<-unlu_merg$ug_biom_x_g*73500


unlu_merg$fungi<-round(unlu_merg$bio.micro*(unlu_merg$ratio.hb/(unlu_merg$ratio.hb+1)),4)
unlu_merg$bacteria<-round((unlu_merg$bio.micro-unlu_merg$fungi),4)

#write.table(unlu_merg[,c(1,2,3,4,6,8,10,12,14,16,258:263,20:138)],"matrizunlu.txt")


```
#### Riqueza en la UNLu
```{r S,echo=FALSE}
library("vegan")
library("BiodiversityR") 
# 1 a 122 hongo:bacterias + 246, 247 

D<-unlu_merg[,c(4:122)]
# son 118 taxones, siquisiera poner nombre a todos...
#colnames(ab)<-spc.colector

rownames(D)<-unlu_merg$nombre

Muestras<-unlu_merg$nombre
Riqueza<-specnumber(D)
Riqueza_nematodos<-specnumber(D[40:44])
Riqueza_lombrices<-specnumber(D[c(2:4,19,61,87:89,93,98,99)])
Riqueza_acari<-specnumber(D[c(5,9,18,26:31,39,45,47:53,55:59,81,82,64:66,68,76,114:117,
                            105,106,108:111,85,102,103,65:67)])
Riqueza_sarcoptiformes<-specnumber(D[c(5,29:31,47:50,57,64:65,68,76,116:117,103,
                            105,106,108,109,85,95)])
Riqueza_mesostigmata<-specnumber(D[c(18,26,28,39,45,51,56,68,66,115,102,96,97)])
Riqueza_prostigmata<-specnumber(D[c(9,27,30,81,82,52,53,55,58,59,76,114,110)])
Riqueza_collembola<-specnumber(D[c(12,16,32,67,46)])
Riqueza_otra_mesofauna<-specnumber(D[c(11,23,104,79)])
Riqueza_macrofauna<-specnumber(D[c(1,6:8,10,13:15,17,20:25,33:38,54,60,62,63,69,
                                 70:75,78,80:84,86,90:92,94,100,101)])


data.frame(Muestras,Riqueza,Riqueza_macrofauna,Riqueza_lombrices,
           Riqueza_sarcoptiformes,Riqueza_mesostigmata, Riqueza_prostigmata,
           Riqueza_collembola,Riqueza_otra_mesofauna,Riqueza_nematodos,
           row.names = NULL)


```
#### Diversidad
```{r H_general, echo=FALSE}

H<-vegan::diversity(D, index="shannon")
diversidad<-round(H,3)
g_H<-data.frame(Muestras,diversidad,row.names = NULL)
g_H$sitio<-substr(g_H$Muestras,1,1)
g_H$replica<-substr(g_H$Muestras,3,3)

g_H.sum<-data.frame(
  sitio=c("A","P","R"),
  promedio=c(
             mean(g_H[g_H$sitio=="A","diversidad"]),
             mean(g_H[g_H$sitio=="P","diversidad"]),
             mean(g_H[g_H$sitio=="R","diversidad"])
                         ),
  "Desvío estandar"=c(
             sd(g_H[g_H$sitio=="A","diversidad"]),
             sd(g_H[g_H$sitio=="P","diversidad"]),
             sd(g_H[g_H$sitio=="R","diversidad"])
                         ),
  Mediana=c(
             median(g_H[g_H$sitio=="A","diversidad"]),
             median(g_H[g_H$sitio=="P","diversidad"]),
             median(g_H[g_H$sitio=="R","diversidad"])
                         )
  ,row.names = NULL
  )

print(g_H.sum)

kruskal.test(diversidad ~ sitio, data = g_H)

```

```{r H_nematodos, echo=FALSE}
microH <- read.delim("~/Documentos/Redes/soil_interaction_web/database/nematofauna_diversityH.txt")

microH$sitio<-substr(microH$nombre,3,3)
microH$replica<-substr(microH$nombre,4,4)

microH[microH$sitio == "L", "sitio"] <- "A"

micro_abH<-microH[,c("nombre","sitio","replica","taxon","abundance")] %>% 
  pivot_wider(names_from = taxon,
              values_from = abundance,
              values_fill = 0,
              values_fn = sum)%>%
  distinct(nombre,.keep_all=TRUE)


H_micro_unlu<-as.matrix(micro_abH[,-c(1:3)])
row.names(H_micro_unlu)<-micro_abH$nombre

H_micro_unlu<-vegan::diversity(H_micro_unlu, index="shannon")

#matriz de diversidad
microabH<-micro_abH[,1:3]
microabH$diversidad<-H_micro_unlu

print(data.frame(habitats=levels(as.factor(microabH$sitio)),
                 mean=c(mean(as.matrix(microabH[microabH$sitio=="A","diversidad"])),
                        mean(as.matrix(microabH[microabH$sitio=="P","diversidad"])),
                        mean(as.matrix(microabH[microabH$sitio=="R","diversidad"]))
                        ),
                 desvio_std=c(
                   sd(as.matrix(microabH[microabH$sitio=="A","diversidad"])),
                        sd(as.matrix(microabH[microabH$sitio=="P","diversidad"])),
                        sd(as.matrix(microabH[microabH$sitio=="R","diversidad"]))
                        ),
                 mediana=c(
                   median(as.matrix(microabH[microabH$sitio=="A","diversidad"])),
                                         median(as.matrix(microabH[microabH$sitio=="P","diversidad"])),
                        median(as.matrix(microabH[microabH$sitio=="R","diversidad"]))
                        ),
                row.names = NULL))

kruskal.test(diversidad ~ sitio, data = microabH)

```


```{r mesoH, echo=FALSE}

mesoH <- read.delim(
  "database/mesofauna_diversityH.txt"
  )

#reasignar nombre a agrícola

mesoH[mesoH$sitio == "L", "sitio"] <- "A"

####################
#Matriz comunidad

mesoH$nombre<-paste(mesoH$sitio,mesoH$replica,mesoH$estrato)

meso_abH<-mesoH[,c("nombre","sitio","replica","estrato","taxon","conteo")] %>% 
  pivot_wider(names_from = taxon,
              values_from = conteo,
              values_fill = 0,
              values_fn = sum)%>%
  distinct(nombre,.keep_all=TRUE)

H_meso_unlu<-as.matrix(meso_abH[,-c(1:4)])
row.names(H_meso_unlu)<-meso_abH$nombre

H_meso_unlu<-vegan::diversity(H_meso_unlu, index="shannon")

#matriz de diversidad
mesoabH<-meso_abH[,1:4]
mesoabH$diversidad<-H_meso_unlu


print("Tabla de Promedio y desvío standar del índice de Shannon en cada sistema de uso del suelo")

print(data.frame(habitats=levels(as.factor(paste(mesoabH$sitio,mesoabH$estrato))),
                 mean=c(
                   mean(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="10","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="fragmentado","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="hoja","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="humus","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="10","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="fragmentado","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="hoja","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="humus","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="10","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="fragmentado","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="hoja","diversidad"])),
                   mean(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="humus","diversidad"]))),
                 desvio_std=c(
                   sd(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="10","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="fragmentado","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="hoja","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="humus","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="10","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="fragmentado","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="hoja","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="humus","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="10","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="fragmentado","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="hoja","diversidad"])),
                   sd(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="humus","diversidad"]))),
                 mediana=c(
                   median(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="10","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="fragmentado","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="hoja","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="A" & mesoabH$estrato=="humus","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="10","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="fragmentado","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="hoja","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="P" & mesoabH$estrato=="humus","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="10","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="fragmentado","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="hoja","diversidad"])),
                   median(as.matrix(mesoabH[mesoabH$sitio=="R" & mesoabH$estrato=="humus","diversidad"]))),
                row.names = NULL))


kruskal.test(diversidad ~ sitio, data = mesoabH, subset=mesoabH$estrato=="hoja");#p-valor h[[3]][1]; estadístico Chi h[[1]][[1]]
kruskal.test(diversidad ~ sitio, data = mesoabH, subset=mesoabH$estrato=="fragmentado")
kruskal.test(diversidad ~ sitio, data = mesoabH, subset=mesoabH$estrato=="humus")
kruskal.test(diversidad ~ sitio, data = mesoabH, subset=mesoabH$estrato=="10")

```

```{r macroH,echo=FALSE}
macroH <- read.delim("~/Documentos/Redes/soil_interaction_web/database/macrofauna_diversityH.txt")

#reasignar nombre a agrícola

macroH[macroH$sitio == "L", "sitio"] <- "A"

####################
#Matriz comunidad

macroH$nombre<-paste(macroH$sitio,macroH$replica,macroH$estrato)

macro_abH<-macroH[,c("nombre","sitio","replica","estrato","taxon","abundance")] %>% 
  pivot_wider(names_from = taxon,
              values_from = abundance,
              values_fill = 0,
              values_fn = sum)%>%
  distinct(nombre,.keep_all=TRUE)

H_macro_unlu<-as.matrix(macro_abH[,-c(1:4)])
row.names(H_macro_unlu)<-macro_abH$nombre

H_macro_unlu<-vegan::diversity(H_macro_unlu, index="shannon")

#matriz de diversidad
macroabH<-macro_abH[,1:4]
macroabH$diversidad<-H_macro_unlu

print("Tabla de Promedio y desvío standar del índice de Shannon en cada sistema de uso del suelo")

print(data.frame(habitats=levels(as.factor(paste(macroabH$sitio,macroabH$estrato))),
                 mean=c(
                   mean(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="10","diversidad"])),
                   mean(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="20","diversidad"])),
                   mean(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="H","diversidad"])),
                   mean(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="10","diversidad"])),
                   mean(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="20","diversidad"])),
                   mean(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="H","diversidad"])),
                   mean(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="10","diversidad"])),
                   mean(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="20","diversidad"])),
                   mean(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="H","diversidad"]))),
                 desvio_std=c(
                   sd(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="10","diversidad"])),
                   sd(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="20","diversidad"])),
                   sd(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="H","diversidad"])),
                   sd(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="10","diversidad"])),
                   sd(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="20","diversidad"])),
                   sd(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="H","diversidad"])),
                   sd(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="10","diversidad"])),
                   sd(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="20","diversidad"])),
                   sd(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="H","diversidad"]))),
                 mediana=c(
                   median(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="10","diversidad"])),
                   median(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="20","diversidad"])),
                   median(as.matrix(macroabH[macroabH$sitio=="A" & macroabH$estrato=="H","diversidad"])),
                   median(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="10","diversidad"])),
                   median(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="20","diversidad"])),
                   median(as.matrix(macroabH[macroabH$sitio=="P" & macroabH$estrato=="H","diversidad"])),
                   median(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="10","diversidad"])),
                   median(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="20","diversidad"])),
                   median(as.matrix(macroabH[macroabH$sitio=="R" & macroabH$estrato=="H","diversidad"]))),
                row.names = NULL))

kruskal.test(diversidad ~ sitio, data = macroabH, subset=macroabH$estrato=="H")
kruskal.test(diversidad ~ sitio, data = macroabH, subset=macroabH$estrato=="10")
kruskal.test(diversidad ~ sitio, data = macroabH, subset=macroabH$estrato=="20")


```


#### Multivariado de la comunidad
``` {r anosim_unlu, echo=FALSE, warning=FALSE}

tb_D_anosim<-D
row.names(tb_D_anosim)<-unlu_merg$nombre
tb_D_anosim1<-tb_D_anosim
tb_D_anosim1$sitio<-unlu_merg$sitio
tb_Duni_anosim<-decostand(tb_D_anosim[,-1],"log")
#col_sp<-colnames(tb_D)

D_unlu_anosim<-vegan::anosim(tb_Duni_anosim, 
              as.matrix(tb_D_anosim1[,"sitio"]), 
              permutations = 1670, 
              distance = "bray")
print("Resumen del ANOSIM para los datos de densidad log +1 transformados")
summary(D_unlu_anosim)

```

Si bien no se encontraron diferencias en los valores de la diversidad del índice de shannon según 
la prueba de Kruskall-Wallis al p-valor menor de 0.05 el análisis de similitudes de las comunidades
nos muestra que existen disimilaridades en la comunidades.
Se observa en la disimilariad de rangos que el R es más disimil entre sí que los de A y P,
lo que marca una comunidad más heterogénea, o tal ve más diversa. La disimilaridad entre
los grupos fué más alta que la de entre los grupos. EL valor de R = 0.76 indica la
diferencia entre grupos es alta y su p valor nos indica que es significativa.

```{r Beta_div, echo=FALSE, warning=FALSE}

#uso matriz de abundancias
beta_u<-unlu_merg[,123:241]
row.names(beta_u)<-unlu_merg$"nombre"
#método 8 es el índice de wilson
#beta_div_u<-betadiver(beta_u, method=8)
beta_div_u<-beta_div_u<-betadiver(beta_u, method=8)#vegdist(beta_u, method="bray")
div.beta.unlu<-hclust(beta_div_u,method = "average")
plot(div.beta.unlu,cex=0.6,main="Agrupamiento promedio Bray-Curtis",sub="Diversidad Beta entre sitios",ylab="Bray-Curtis",xlab="")
#linea de corte
#abline(h = 0.29, lty = 2, col = "black")

```

La disimilitud de las comunidades con el índice de Bray-Curtis y mediante agrupamiento
jerárquico del tipo promedio, nos muestra una relación de similitud en el lote agrícola
que permite agruparlo como una comunidad disimil de las demás en la composición de la
comunidad respecta. De manera similar la Reserva y el Pastizal son disímiles parcialmente
entre sí ya que existe una relación de similitud entre una repeticiones de R y una
repetición de P, lo que nos podría estar mostrando el gradiente Reserva hacia Pastizal.
Las demás repeticiones forman grupos particulares a cada ambiente o sistema de uso del
suelo.

```{r pca_tb, echo=FALSE,warning=FALSE}

tb_D_U<-decostand(D,"hellinger")
row.names(tb_D_U)<-unlu_merg$"nombre"
col_sp<-colnames(tb_D_U)

col.sp.unlu<-c("macro_herb","ing","ing","ing","ast","macro_pred","macro_fun",
               "macro_det","pros","macro_det","enchy","art","macro_omn","macro_pred",
               "macro_herb","art","macro_pred","meso","ing","macro_det","macro_herb",
               "macro_pred","no.art","macro_det","macro_herb","meso","pros","meso",
               "orib","pros","orib","art","macro_pred","macro_herb","macro_det",
               "macro_fun","macro_det","macro_det","meso","nem_bac","nem_fit",
               "nem_fung","nem_omn","nem_pre","meso","art","orib","orib","orib",
               "orib","meso","pros","pros","macro_det","pros","meso","orib","pros",
               "pros","macro_pred","ing","macro_det","macro_pred","orib","orib",
               "meso",
               "no.art","meso","macro_det","macro_herb","macro_herb","macro_pred",
               "macro_parasi","macro_det","macro_no","pros","tardi","macro_pred",
               "no.art","macro_pred","pros","pros","macro_herb","macro_herb","orib",
               "macro_det","ing","ing","ing","macro_det","macro_det","macro_pred",
               "ing","macro_det","orib","meso","meso","ing","ing","macro_det",
               "macro_det","meso","orib","no.art","orib","orib","macro_no",
               "orib","orib","no.art","orib","macro_fun","macro_det","pros","meso",
               "orib","orib","macro_pred","macro_herb")

#Matriz transpuesta
tb_U_D_pca<-PCA(t(tb_D_U), scale.unit = TRUE, graph = FALSE)
summary(tb_U_D_pca)
##corelaciones
f_pca_cor<-round(tb_U_D_pca$var$cor[,1:4],3)
#Biplot
sit<-c(rep("A", 3), rep("P", 3), rep("R", 3))
fviz_pca_biplot(tb_U_D_pca, axes = c(1,2),  col.var=sit, col.ind =as.factor(col.sp.unlu) , label = "none")

#col.ind =as.factor(col.sp.unlu)

```

Observando el PCA y colocando los sitios como variables. La comunidad de especies separa
claramente al Lote de la Reserva y el Pastizal estará en una situación intermediaen cuanto
a composición de la comunidad.

si consideramos por grandes grupos, los ing, macro det, macro herb, macro fung, no art
forman un cluster entre centroides.

los tardigrados se alej y se relacionan con la Reserva

Los nemátodos Artroleonas y Astigmata estan formando otro cluster y opuesto al anterior y
son descrito por el primer eje

los mesostigmata y macropredadora no se explican por los ejes y se encuentran cercanos al
0 0

Los prostigmata explicados por el 2do eje en sentido negativo se relacionan con los lotes

Los oribátidos se relacionan con la Reserva

## Comunidad de la fauna edáfica Sandler (2019)

Trabajaré con la base de datos completa sin considerar las submuestras,
ya que las sub muestras deben ser agrupadas para evitar la autocorrelación

Es necesario llevar las abundancias de los animales a valores de densidad
ya que las lombrices fueron tomadas con monolitos (factor= 16)
y los microartrópodos con sacabocados (factor= 509.2958).

A la vez se redondean los valores hacia el más bajo, de esta manera
las lombrices tendrían 16 ind/m² y los microartrópodos 510 ind/m².

A partir de este se calcula la Biomasa de los organismos


```{r matricesRO, echo=FALSE, warning=FALSE}
#Anális de datos de ROSANA
#Carga de datos

RO <-RO <- read_excel("./database/soil_networks.xlsx", sheet = "Ro_web")
RO[is.na(RO)]<-0

#Filtrar la macrofauna, razon, el diseño de muestreo no lo contempla

RO_f<-RO %>% filter(class!="macrofauna")%>%
  mutate(nombre=paste(system,
                                    substr(site,1,3),
                                    substr(year,3,4),
                                    substr(month,1,3)))%>%
  group_by(nombre,
           system,site,year,month,season,
           order,guild,specie) %>%
  summarise(abundance=n(), peso.ind=median(biomass), 
            bmicro=(median(bm)), 
            res.mec=median((RM5+RM10)/2),DAP=median(DAP),HR=median(HR),
            pH=median(Ph),CE=median(CE),
            MO=median(MO),N=median(N),P=median(P),K=median(K),
            Ca=median(Ca),Mg=median(Mg),Na=median(Sodio),respH=mean(RESP))%>%
  distinct(specie,.keep_all=TRUE)

#####################
#Llevando abundancias a densidad

sup.bocado <- 1/(pi*2.5^2/10000)
sup.monolito <- 1/(0.25*0.25)

#################
RO_full<-RO_f%>%mutate(D=floor(case_when(
  order=="crassiclitellata"~sup.monolito*abundance,
  order!="crassiclitellata"~sup.bocado*abundance)
  ),BT=D*peso.ind)

##################
#Matriz de comunidad

abund_RO<-RO_full[,c("nombre","system","site","specie","abundance","D")] %>% 
  pivot_wider(names_from = specie,
              values_from = c(abundance,D),
              values_fill = 0,
              values_fn = sum)%>%
  distinct(nombre,.keep_all=TRUE)

fq_RO<-RO_full%>%group_by(nombre,
           system,site,year,month,season,
           )%>%
  summarise(res.mec=mean(res.mec),DAP=mean(DAP),HR=mean(HR),
            pH=mean(pH),CE=mean(CE),
            MO=mean(MO),N=mean(N),P=mean(P),K=mean(K),
            Ca=mean(Ca),Mg=mean(Mg),Sodio=mean(Na),rH=mean(respH))%>%
  distinct(nombre,.keep_all=TRUE)
#Asignar número de réplica según la tesis de Rosana. pp53 tabla 2.1.
#En el espectro de tamaños esto se encuentra con sus nombres.
fq_RO$replica
fq_RO[fq_RO$site=="triangulo","replica"]<-1
fq_RO[fq_RO$site=="L27","replica"]<-1
fq_RO[fq_RO$site=="molino","replica"]<-1

fq_RO[fq_RO$site=="festuca","replica"]<-2
fq_RO[fq_RO$site=="L24","replica"]<-2
fq_RO[fq_RO$site=="manga","replica"]<-2

fq_RO[fq_RO$site=="romina","replica"]<-3
fq_RO[fq_RO$site=="L25","replica"]<-3
fq_RO[fq_RO$site=="casuarina","replica"]<-3

#En esta matriz e datos completa se encuentra la réplica

RO_db_full <- merge(fq_RO, abund_RO, by = "nombre", all = TRUE)
name.RO_db_full<-c(names(RO_db_full))

names(RO_db_full)<-c("nombre","system","site",name.RO_db_full[-c(1:3)])

```


Trabajaré con la base de datos completa sin considerar las submuestras,
ya que las sub muestras deben ser agrupadas para evitar la autocorrelación

Es necesario llevar las abundancias de los animales a valores de densidad
ya que las lombrices fueron tomadas con monolitos (factor= 16)
y los microartrópodos con sacabocados (factor= 509.2958).

A la vez se redondean los valores hacia el más bajo, de esta manera
las lombrices tendrían 16 ind/m² y los microartrópodos 510 ind/m².

A partir de este se calcula la Biomasa de los organismos

### Variables físcas y químicas, resumen datos Sandler(2019)

Trabajar con las variables similares a las de la comunidad de la UNLu, para análisis 
completto ir a la tesis.

#### Descriptivas
Solo tabular las variables. No realizar boxplot.
```{r pH_RO,echo=FALSE}
pH.df<-data.frame(uso=levels(as.factor(RO_db_full$system)),
                 promedio=c(mean(RO_db_full[RO_db_full$system=="A","pH"]),
                        mean(RO_db_full[RO_db_full$system=="G","pH"]),
                        mean(RO_db_full[RO_db_full$system=="N","pH"])
                        ),
                sd=c(sd(RO_db_full[RO_db_full$system=="A","pH"]),
                        sd(RO_db_full[RO_db_full$system=="G","pH"]),
                        sd(RO_db_full[RO_db_full$system=="N","pH"])
                        ),
                mediana=c(median(RO_db_full[RO_db_full$system=="A","pH"]),
                        median(RO_db_full[RO_db_full$system=="G","pH"]),
                        median(RO_db_full[RO_db_full$system=="N","pH"])
                        ),
                 quartil_1=c(quantile(RO_db_full[RO_db_full$system=="A","pH"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="G","pH"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="N","pH"],prob=0.25)
                        ),
                quartil_3=c(quantile(RO_db_full[RO_db_full$system=="A","pH"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="G","pH"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="N","pH"],prob=0.75)
                        ),
                row.names = NULL)

kruskal.test(pH ~ system, data = RO_db_full)
pairwise.wilcox.test(RO_db_full$pH, RO_db_full$system,data=RO_db_full,
                                          p.adjust.method = "BH")
{boxplot(pH ~ system, data = RO_db_full, main = "potencial Hidrógeno")
x_coords <- c(0.7, 1.7, 2.7)  # Coordenadas x para las letras
y_coords <- rep(8.8, 3)  # Coordenadas y para las letras

# Letras a colocar
letras <- c("b", "b", "a")

# Agregar las letras al gráfico
text(x = x_coords, y = y_coords, labels = letras, col = "black", cex = 0.9)}



```

```{r CE_RO, echo=FALSE}


CE.df<-data.frame(uso=levels(as.factor(RO_db_full$system)),
                 promedio=c(mean(RO_db_full[RO_db_full$system=="A","CE"]),
                        mean(RO_db_full[RO_db_full$system=="G","CE"]),
                        mean(RO_db_full[RO_db_full$system=="N","CE"])
                        ),
                sd=c(sd(RO_db_full[RO_db_full$system=="A","CE"]),
                        sd(RO_db_full[RO_db_full$system=="G","CE"]),
                        sd(RO_db_full[RO_db_full$system=="N","CE"])
                        ),
                mediana=c(median(RO_db_full[RO_db_full$system=="A","CE"]),
                        median(RO_db_full[RO_db_full$system=="G","CE"]),
                        median(RO_db_full[RO_db_full$system=="N","CE"])
                        ),
                 quartil_1=c(quantile(RO_db_full[RO_db_full$system=="A","CE"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="G","CE"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="N","CE"],prob=0.25)
                        ),
                quartil_3=c(quantile(RO_db_full[RO_db_full$system=="A","CE"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="G","CE"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="N","CE"],prob=0.75)
                        ),
                row.names = NULL)

kruskal.test(CE ~ system, data = RO_db_full)
pairwise.wilcox.test(RO_db_full$CE, RO_db_full$system,data=RO_db_full,
                                          p.adjust.method = "BH")
{boxplot(CE ~ system, data = RO_db_full, main = "Conductividad Eléctrica ms/cm")
x_coords <- c(0.7, 1.7, 2.7)  # Coordenadas x para las letras
y_coords <- rep(3.7, 3)  # Coordenadas y para las letras

# Letras a colocar
letras <- c("b", "b", "a")

# Agregar las letras al gráfico
text(x = x_coords, y = y_coords, labels = letras, col = "black", cex = 0.9)}

```


```{r MO_RO,echo=FALSE}

MO.df<-data.frame(uso=levels(as.factor(RO_db_full$system)),
                 promedio=c(mean(RO_db_full[RO_db_full$system=="A","MO"]),
                        mean(RO_db_full[RO_db_full$system=="G","MO"]),
                        mean(RO_db_full[RO_db_full$system=="N","MO"])
                        ),
                sd=c(sd(RO_db_full[RO_db_full$system=="A","MO"]),
                        sd(RO_db_full[RO_db_full$system=="G","MO"]),
                        sd(RO_db_full[RO_db_full$system=="N","MO"])
                        ),
                mediana=c(median(RO_db_full[RO_db_full$system=="A","MO"]),
                        median(RO_db_full[RO_db_full$system=="G","MO"]),
                        median(RO_db_full[RO_db_full$system=="N","MO"])
                        ),
                 quartil_1=c(quantile(RO_db_full[RO_db_full$system=="A","MO"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="G","MO"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="N","MO"],prob=0.25)
                        ),
                quartil_3=c(quantile(RO_db_full[RO_db_full$system=="A","MO"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="G","MO"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="N","MO"],prob=0.75)
                        ),
                row.names = NULL)

kruskal.test(MO ~ system, data = RO_db_full)
pairwise.wilcox.test(RO_db_full$MO, RO_db_full$system,data=RO_db_full,
                                          p.adjust.method = "BH")
boxplot(MO ~ system, data = RO_db_full, main = "% Materia Orgánica")

```


```{r N_RO,echo=FALSE}

N.df<-data.frame(uso=levels(as.factor(RO_db_full$system)),
                 promedio=c(mean(RO_db_full[RO_db_full$system=="A","N"]),
                        mean(RO_db_full[RO_db_full$system=="G","N"]),
                        mean(RO_db_full[RO_db_full$system=="N","N"])
                        ),
                sd=c(sd(RO_db_full[RO_db_full$system=="A","N"]),
                        sd(RO_db_full[RO_db_full$system=="G","N"]),
                        sd(RO_db_full[RO_db_full$system=="N","N"])
                        ),
                mediana=c(median(RO_db_full[RO_db_full$system=="A","N"]),
                        median(RO_db_full[RO_db_full$system=="G","N"]),
                        median(RO_db_full[RO_db_full$system=="N","N"])
                        ),
                 quartil_1=c(quantile(RO_db_full[RO_db_full$system=="A","N"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="G","N"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="N","N"],prob=0.25)
                        ),
                quartil_3=c(quantile(RO_db_full[RO_db_full$system=="A","N"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="G","N"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="N","N"],prob=0.75)
                        ),
                row.names = NULL)

kruskal.test(N ~ system, data = RO_db_full)
pairwise.wilcox.test(RO_db_full$N, RO_db_full$system,data=RO_db_full,
                                          p.adjust.method = "BH")
{boxplot(N ~ system, data = RO_db_full, main = "% Nitrógeno")
x_coords <- c(0.7, 1.7, 2.7)  # Coordenadas x para las letras
y_coords <- rep(0.4, 3)  # Coordenadas y para las letras

# Letras a colocar
letras <- c("b", "a", "b")

# Agregar las letras al gráfico
text(x = x_coords, y = y_coords, labels = letras, col = "black", cex = 0.9)}

```


```{r P_RO,echo=FALSE}

P.df<-data.frame(uso=levels(as.factor(RO_db_full$system)),
                 promedio=c(mean(RO_db_full[RO_db_full$system=="A","P"]),
                        mean(RO_db_full[RO_db_full$system=="G","P"]),
                        mean(RO_db_full[RO_db_full$system=="N","P"])
                        ),
                sd=c(sd(RO_db_full[RO_db_full$system=="A","P"]),
                        sd(RO_db_full[RO_db_full$system=="G","P"]),
                        sd(RO_db_full[RO_db_full$system=="N","P"])
                        ),
                mediana=c(median(RO_db_full[RO_db_full$system=="A","P"]),
                        median(RO_db_full[RO_db_full$system=="G","P"]),
                        median(RO_db_full[RO_db_full$system=="N","P"])
                        ),
                 quartil_1=c(quantile(RO_db_full[RO_db_full$system=="A","P"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="G","P"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="N","P"],prob=0.25)
                        ),
                quartil_3=c(quantile(RO_db_full[RO_db_full$system=="A","P"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="G","P"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="N","P"],prob=0.75)
                        ),
                row.names = NULL)
kruskal.test(P ~ system, data = RO_db_full)
pairwise.wilcox.test(RO_db_full$P, RO_db_full$system,data=RO_db_full,
                                          p.adjust.method = "BH")
boxplot(P ~ system, data = RO_db_full, main = "Fósforo asimilable en ppm")

```


```{r respH_RO,echo=FALSE}

rH.df<-data.frame(uso=levels(as.factor(RO_db_full$system)),
                 promedio=c(mean(RO_db_full[RO_db_full$system=="A","rH"]),
                        mean(RO_db_full[RO_db_full$system=="G","rH"]),
                        mean(RO_db_full[RO_db_full$system=="N","rH"])
                        ),
                sd=c(sd(RO_db_full[RO_db_full$system=="A","rH"]),
                        sd(RO_db_full[RO_db_full$system=="G","rH"]),
                        sd(RO_db_full[RO_db_full$system=="N","rH"])
                        ),
                mediana=c(median(RO_db_full[RO_db_full$system=="A","rH"]),
                        median(RO_db_full[RO_db_full$system=="G","rH"]),
                        median(RO_db_full[RO_db_full$system=="N","rH"])
                        ),
                 quartil_1=c(quantile(RO_db_full[RO_db_full$system=="A","rH"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="G","rH"],prob=0.25),
                        quantile(RO_db_full[RO_db_full$system=="N","rH"],prob=0.25)
                        ),
                quartil_3=c(quantile(RO_db_full[RO_db_full$system=="A","rH"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="G","rH"],prob=0.75),
                        quantile(RO_db_full[RO_db_full$system=="N","rH"],prob=0.75)
                        ),
                row.names = NULL)
kruskal.test(rH ~ system, data = RO_db_full)
pairwise.wilcox.test(RO_db_full$rH, RO_db_full$system,data=RO_db_full,
                                          p.adjust.method = "BH")
{boxplot(rH ~ system, data = RO_db_full, main = "Respiración Heterotrófica mmC/g*dia")
x_coords <- c(0.7, 1.7, 2.7)  # Coordenadas x para las letras
y_coords <- rep(0.18, 3)  # Coordenadas y para las letras

# Letras a colocar
letras <- c("b", "a", "a")

# Agregar las letras al gráfico
text(x = x_coords, y = y_coords, labels = letras, col = "black", cex = 0.9)}

```

#### Multivariado
```{r cor_RO,echo=FALSE}
corrRO<-Hmisc::rcorr(as.matrix(RO_db_full[,c(10:14,19)]),type = "pearson");corrRO[1];corrRO[3]

#corrplot::corrplot(cor(as.matrix(RO_db_full[,c(10:14,19)])),tl.pos="t",type = "upper",tl.col = "black",tl.cex = .8,bg="brown4",diag=FALSE)
```

** Análisis de Componentes Prinipales de los sitios de estudio
en función de sus variables físicas y químicas **

```{r pcaFQ_RO,echo=FALSE}
################
#FyQ Completo con todas y densidades estandarizadas
sit<-RO_db_full$system
#tb_fq<-decostand(RO_db_full[,c(10:14,19)],"log")
#quito la variable 19, que es la respiracion porque sesga
#f_pca<-PCA(tb_fq, scale.unit = TRUE, graph = FALSE)
#No se usa valor transformado
f_pca<-PCA(RO_db_full[,c(10:14,19)], scale.unit = TRUE, graph = FALSE)
summary(f_pca)
##corelaciones
f_pca_cor<-round(f_pca$var$cor[,1:4],3)
#Biplot
fviz_pca_biplot(f_pca, axes = c(1,2),  col.ind=sit, label = "var")
```



En PCA considerando las variables físicas y químicas de manera transformada y 
considerando que las submuestras se encuentran agrupadas, 
se pueden observar la separación de 3 grupos como una especie de función donde f y g de x se aproximan a h y por lo tanto sirven para calcular valores en ella.

Por un lado inicia el sistema G, le sigue el A y el N al final.

Observando los vectores representan a G la concentración de nitrógeno en el suelo 
y un tanto la proporción de fósforo casi marginalmente y tambien un poco 
relacionado con el A

Para A resulta clara la relacion con el contenido de MO y HR en el suelo, 
aunque también la CE se relaciona con este y marginalmente con N.

En N varias variables se encontraron bien correlacionadas entre ellas el DAP el 
sodio el pH y el Calcio, también la resistencia mecánica y los aumentos en sus 
valores son asociados particularmente con el sistema N y el contenido de K que 
resulta importante.


### Diversidad de las comunidades edáficas que habitan los campos Sandler(2019)

#### Riqueza de especies

```{r rqza_RO, echo=FALSE,warning=FALSE}

######

#Lista de especie agrupadas según el colector
#De los datos brutos de RO
#Arrastrado a partir de los agrupamientos y pivoteo en ancho
#Nombres tomados de la columnas de abun_RO y "reformateados"
spc.colector<-c("Apo_cal","Apo_tra", "Mic_dub",
                "lom_juv","isotomidae",  "epilohmannioidea",
                "euphthiracaroidea","oripodoidea","oppioidea",
                "onychiuridae","Apo_ros",
                "parasitoidea","ceratozetoidea",
                "brachychthonioidea","crotonioidea","hypogastruridae",
                "eupodoidea","veigaioidea",
                "entomobroidea","rhodacaroidea",
                "galumnioidea","symphypleona",
               "octala","bdelloidea",
                "dermanyssoidea","trombidioidea",
                "octacy","acaroidea",
                "tydeoidea","uropodoidea","mesostigmata",
                "euker","oribatida","Mic_pho")

#Lo llamo Abun pero es Densidad
#abund_RO[,4:55]
ab<-RO_db_full[,23:56]
colnames(ab)<-spc.colector

print("Tabla de riqueza de especies por cada sitio")
print(data.frame(Sitios=levels(as.factor(paste(RO_db_full$system,RO_db_full$replica))),Riqueza=specnumber(ab,groups=abund_RO$site),row.names = NULL))

```
<!--La riqueza por sistema de uso del suelo, considerando algunas especies de la mesofauna que no corresponden a ácaros y colémbolos, es de A = 44; G = 39; N = 38.-->


#### Diversidad

```{r}
# Diversidad Total se trabaja con abundancias

mtxRO_D<-RO_db_full[,c(20:22,57:90)]
mtxRO_D$nombre<-paste(mtxRO_D$system.x,mtxRO_D$replica)


H_RO.D<-as.matrix(mtxRO_D[,-c(1:3,38)])
row.names(H_RO.D)<-mtxRO_D$nombre

H_RO<-vegan::diversity(H_RO.D, index="shannon")

#matriz de diversidad
RO_div<-mtxRO_D[,c(1:3,38)]

RO_div$diversidad<-H_RO
names(RO_div)<-c("replica","sitio","n_sit","nombre","diversidad")

print(data.frame(habitats=levels(as.factor(RO_div$sitio)),
                 mean=c(mean(as.matrix(RO_div[RO_div$sitio=="A","diversidad"])),
                        mean(as.matrix(RO_div[RO_div$sitio=="G","diversidad"])),
                        mean(as.matrix(RO_div[RO_div$sitio=="N","diversidad"]))
                        ),
                 desvio_std=c(sd(as.matrix(RO_div[RO_div$sitio=="A","diversidad"])),
                        sd(as.matrix(RO_div[RO_div$sitio=="G","diversidad"])),
                        sd(as.matrix(RO_div[RO_div$sitio=="N","diversidad"]))
                        ),
                 mediana=c(median(as.matrix(RO_div[RO_div$sitio=="A","diversidad"])),
                        median(as.matrix(RO_div[RO_div$sitio=="G","diversidad"])),
                        median(as.matrix(RO_div[RO_div$sitio=="N","diversidad"]))
                        ),
                row.names = NULL))

kruskal.test(diversidad ~ sitio, data = RO_div)



```
### Multivariado de la comunidad


```{r anosim, include=FALSE, warning=FALSE}
#Densidad nro ind/m2
#Se utiliará la transformación "log" = (log x) + 1 si x > 0 o 0 si x = 0
#Especies ocasionales, no muestreados correctamente
#En total 18 especies, 

spe.no<-c(6,13,20,22,24,27,28,29,30,31,33,36,40,42,46,50,51,52)

#########################
#Listado completo de especies
D_anosim<-RO_db_full[,c(1,2,3,20,57:90)]
colnames(D_anosim)<-c("nombre","system","site","replica",spc.colector)

tb_D<-decostand(D_anosim[,-c(1:4)],"log")

Den_anosim<-vegan::anosim(tb_D, 
              as.matrix(D_anosim[,"system"]), 
              permutations = 1670, 
              distance = "bray")
print("Resumen del ANOSIM para los datos de densidad log +1 transformados")
summary(Den_anosim)

```

ANOSIM nos muestra que existen diferencias en las comunidades en sus valores densidad y de peso que han sido previamente transformadas pero no re escaladas. 

Si se consideran las matrices con todas las especies o sin las especies submuestreadas, los valores muestran patrones semejantes.

Estos patrones son: 
  1. diferencias significativas en las comunidades considerando la densidad de los organismos y también considerando los pesos corporales de la fauna edáfica.
  2. Valores de r^2^ interpretados como poder de explicación de la variabilidad de los datos por parte de los sistemas de uso del suelo bajos, < a 15
  3. Valores de r^2^ siempre más altos para el peso de los organismos que para su densidad. 
  
En general el anosim filtrado no aumenta mucho el valor del modelos no filtrado.

```{r Beta, echo=FALSE, warning=FALSE}

D_site<-RO_full[,c("system","site","specie","D")] %>% 
  pivot_wider(names_from = specie,
              values_from = D,
              values_fill = 0,
              values_fn = sum)%>%
  distinct(system,.keep_all=TRUE)
D_site<-as.data.frame(D_site)
D_site$replica
D_site[D_site$site=="triangulo","replica"]<-1
D_site[D_site$site=="L27","replica"]<-1
D_site[D_site$site=="molino","replica"]<-1

D_site[D_site$site=="festuca","replica"]<-2
D_site[D_site$site=="L24","replica"]<-2
D_site[D_site$site=="manga","replica"]<-2

D_site[D_site$site=="romina","replica"]<-3
D_site[D_site$site=="L25","replica"]<-3
D_site[D_site$site=="casuarina","replica"]<-3

row.names(D_site)<-paste(D_site$system,D_site$replica)

######
# Disimilitudd entre los sitios
betaBK_ro<-betadiver(D_site[,-c(1,2,55)],method=8)
  
div.beta<-hclust(betaBK_ro,method = "average")
plot(div.beta,cex=0.6,main="Agrupamiento según Wilson",sub="Diversidad Beta entre sitios",ylab="Índice de Bray Curtis",xlab="")

#######
# Índice de Beta Diveridad
#beta<-betadiver(D_site[,-c(1,2)], method=8)
#div.beta<-hclust(beta,method = "mcquitty")
#plot(div.beta,cex=0.6,main="Agrupamiento según índice Wilson",sub="Diversidad Beta entre sitios",ylab="Índice de Wilson",xlab="")

```
Globalmente se observa separación de los diferentes sitios. El triángulo que es pastizal naturalizado esta levemente relacionado a los agrícolas.

Living communities are spatially structured at many scales, and
these structures are the result of several classes of processes. On the other hand,
beta diversity is the spatial variation in community composition; so, a study of the
factors that can explain the spatial variation of community composition is in every
respect an analysis of beta diversity. (Numerical Ecology con R pp 228)



** Análisis de Componentes Prinipales de los sitios de estudio
en función de la densidad de la fauna edáfica **

```{r tb_PCA, echo=FALSE}
tb_D<-decostand(D_site[,-c(1,2,37)],"log")
sit<-c(rep("A", 3), rep("G", 3), rep("N", 3))

pch<-c(1,1,1,1,9,5,5,5,5,9,1,6,5,5,5,9,7,6,
         9,6,5,10,1,7,6,7,1,5,
           7,6,6,1,5,1)
col.sp<-pch
col.sp <- case_when(
  col.sp == 1 ~ "lom",
  col.sp == 5 ~ "ori",
  col.sp == 6 ~ "mes",
  col.sp == 7 ~ "pro",
  col.sp == 9 ~ "art",
  col.sp == 10 ~ "no.art",
  TRUE ~ as.character(col.sp)
)

#lombrices=1=lom; macro=3=macro; acaros_orib= 5=ori; ac_meso= 6=mes
#ac_prost=7=pro; artropleona=9=art; no_artropleona=10=no.art



####################
#con Densidades standarizadas por log(ab)+1

std_ab_pca<-PCA(t(tb_D), scale.unit = TRUE, graph = FALSE)


fviz_pca_biplot(std_ab_pca, axes = c(1,2),  col.ind=col.sp, col.var = as.factor(sit),repel = TRUE,label = "none")

summary(std_ab_pca)
#correlaciones
std_ab_pca_cor<-round(std_ab_pca$var$cor[,1:5],3)

#fviz_pca_var(std_ab_pca, col.var=sit,repel = TRUE, label="none")

#fviz_pca_ind(std_ab_pca, col.ind=col.sp,label="none",repel = TRUE)



```





# ref

West, A. W. (1986). Improvement of the selective respiratory inhibition technique to
measure eukaryote: prokaryote ratios in soils. Journal of Microbiological Methods, 5(3-4),
125-138.

Sfeir, A., Costa, M. C., Stavinsky, A., Bonvecchi, V., Penón, E., Rossi, S. 1988. Mapa
básico de suelos. Universidad Nacional de Luján, Luján.

Potapov, A. M., Sun, X., Briones, M. J., Brown, G., Cameron, E., Cortet, J., ... & Wall,
D. (2022). Global monitoring of soil animal communities using a common methodology.
bioRxiv.

Zabala, M., & Gómez, Y. (2010). Biomasa fúngica y bacteriana como indicadoras del
secuestro de C en suelos de sabanas sustituidos por pinares en Uverito, Venezuela. Revista
de Biología Tropical, 58(3), 977-989.

Moreira, F. M., Huising J. E. - Bignell, D. E.(Ed.). (2012). Manual de biología de suelos
tropicales. Instituto Nacional de Ecología. Muestreo y caracterización de la biodiversidad
bajo suelo. Cap Nematodos pp165 ---- Agregar Capitulo Macrofauna

Swift M, Heal O, Anderson J (1979) Decomposition in terrestial ecosystems. CAB URL:
<https://www.cabdirect.org/cabdirect/abstract/19800665274>

Frioni, L. 1999. Procesos microbianos. Anexo Práctico. p 290-295 Ed. de la Fundación
Universidad Nacional de Río Cuarto. Argentina. 322 páginas.

Measuring beta diversity for presence–absence data Koleff et al 2003 

S URRICARIET, R S LAVADO 1999 INDICADORES DE DETERIORO EN SUELOS DE LA PAMPA ONDULADA

R.P. Colombo, L. Fernández Bidondo, V.A. Silvani, M.B. Carbonetto, N. Rascovan, M.J. Bompadre,
M. Pérgola, G. Cuenca, and A.M. Godeas. 2014. Diversity of arbuscular mycorrhizal fungi in soil from the
Pampa Ondulada, Argentina, assessed by pyrosequencing and
morphological techniques

Socarras 2013 Soil mesofauna: biological indicator of soil quality

Bedano et al 2006 Influence of three different land management practices on soil
mite (Arachnida: Acari) densities in relation to a natural soil
